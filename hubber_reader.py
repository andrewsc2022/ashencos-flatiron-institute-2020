import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

def readcsv(file_str):

    tests = pd.read_csv(file_str, encoding='unicode_escape')
    testsd = pd.DataFrame(data = tests)
    return(testsd)

threshold = float(input("Threshold: "))
income = readcsv("Hubber_Files/within_hubber.csv")

newincome = pd.DataFrame(income)

np.seterr(divide='ignore', invalid='ignore')
newincome.pop("Function")
newincome = newincome.T

print("\U0001f600")

exclude_list = ["29974", "65985", "79719", "22848", "14", "16", "80755", "10157", "5243", "5244", "215", "5825", "83451", "26090", "84836", "29", "10449", "31", "27034", "37", "38", "39", "84320", "59272", "22985", "47", "641371", "55856", "10005", "51", "52", "53", "2180", "2181", "2182", "51703", "84532", "58", "59", "60", "345651", "87", "10120", "10097", "10096", "57180", "97", "100", "104", "56997", "118", "128", "132", "11047", "158", "174", "175", "3268", "55326", "10551", "155465", "183", "79026", "113146", "64853", "83543", "51390", "9255", "204", "50808", "205", "9590", "11214", "11217", "9465", "10270", "10142", "10327", "231", "441282", "1645", "1646", "8644", "8574", "207", "213", "5832", "216", "8854", "219", "217", "218", "224", "221", "8659", "7915", "223", "226", "230", "56052", "440138", "79868", "79053", "248", "250", "57679", "51005", "271", "64682", "288", "51479", "54882", "57037", "129138", "23294", "54443", "196527", "8125", "10541", "301", "311", "312", "302", "306", "309", "162", "164", "8907", "1174", "160", "163", "1173", "9179", "328", "8539", "334", "335", "128240", "336", "338", "348", "23780", "351", "26060", "54840", "9716", "372", "377", "378", "381", "84364", "26286", "10564", "10139", "392", "94134", "9138", "27237", "9459", "25820", "23568", "23204", "151188", "83787", "10552", "10095", "10094", "10093", "10092", "10776", "408", "84164", "10973", "25842", "432", "435", "439", "440", "444", "79058", "55054", "471", "475", "476", "481", "483", "488", "489", "490", "492", "493", "498", "506", "509", "513", "515", "516", "10476", "522", "10159", "535", "23545", "50617", "527", "523", "526", "528", "51382", "529", "9550", "10396", "5205", "10079", "93974", "546", "25814", "11273", "552889", "6790", "54998", "9212", "23080", "26229", "9530", "7917", "10458", "55971", "8815", "581", "9031", "4059", "55973", "10134", "8412", "56647", "23786", "9274", "613", "56898", "637", "274", "282991", "388552", "645", "9790", "552900", "2186", "673", "79184", "8019", "23476", "682", "684", "9044", "689", "701", "8896", "705", "9689", "28969", "83638", "91298", "64897", "11161", "84520", "51637", "84326", "57020", "79415", "10438", "56913", "127687", "708", "54976", "60526", "79568", "722", "132321", "285636", "84310", "377677", "51719", "81617", "790", "800", "811", "813", "57118", "817", "818", "55832", "821", "10487", "822", "823", "824", "726", "4076", "829", "830", "23589", "10498", "113201", "57513", "836", "831", "847", "857", "858", "865", "873", "874", "84869", "11335", "23468", "54862", "883", "56267", "115098", "79879", "28952", "55246", "124808", "57003", "284001", "131076", "8030", "317762", "60492", "885", "890", "904", "219771", "151195", "10576", "7203", "22948", "908", "10694", "977", "23607", "960", "4179", "961", "1604", "966", "972", "978", "246184", "51362", "8476", "23580", "988", "79577", "64866", "999", "1015", "54825", "53841", "983", "1017", "1019", "1020", "1022", "1040", "55573", "634", "4680", "1050", "1058", "1063", "201161", "1066", "1069", "10428", "1072", "1073", "494143", "8208", "54927", "131474", "1105", "9557", "55636", "57680", "10523", "1119", "29082", "91782", "91612", "1153", "284106", "11113", "10970", "1163", "1164", "23332", "23122", "1184", "1186", "56650", "1192", "9685", "6249", "7461", "54982", "8192", "81037", "10845", "1213", "8218", "1191", "134147", "152100", "146223", "54918", "112616", "1266", "54805", "26504", "4848", "4849", "9337", "1267", "10330", "10695", "10087", "1289", "51397", "170622", "1312", "1315", "9276", "11316", "50813", "64708", "51004", "57017", "57175", "23603", "79585", "23406", "1353", "51241", "1327", "9377", "1340", "1345", "1349", "1362", "1368", "8904", "221184", "8895", "27132", "144402", "1373", "53981", "79869", "1374", "1376", "54504", "1385", "9419", "51340", "10491", "64784", "1410", "51084", "1431", "7812", "1456", "1465", "1466", "1471", "1478", "23283", "1495", "1496", "1499", "56259", "1500", "56474", "5476", "1508", "1509", "1522", "55917", "90353", "8454", "8453", "51503", "1525", "7852", "80777", "1727", "1535", "54205", "23191", "29785", "54905", "1595", "3491", "1601", "1603", "26007", "1615", "1622", "1627", "80344"]
print("Exclude: ", len(exclude_list))
indices = list(newincome.keys())

new = newincome.loc[newincome[0] >= threshold]
income = readcsv("Hubber_Files/fibroblast_bojkova.csv")
newincome = pd.DataFrame(income)

np.seterr(divide='ignore', invalid='ignore')
newincome.pop("Function")
newincome = newincome.T

indices = list(newincome.keys())

new_2 = newincome.loc[newincome[0] >= threshold]
both = []

for i in list(new_2.index):
	if i in list(new.index):
		both.append(i)

print("Esophagus: ", len(list(new.index)))
print("Fibroblasts: ", len(list(new_2.index)))
print("Int: ", len(both))

income = readcsv("networkcsv.csv")

newincome = pd.DataFrame(income)

np.seterr(divide='ignore', invalid='ignore')

newincome.pop("Function")
newincome = newincome.T

indices = list(newincome.keys())
new_3 = newincome.loc[newincome[0] >= threshold]

print("Global: ", len(list(new.index)))

within = []
for i in list(new.index):
	print(i)
	if i in exclude_list:
		within.append(i)

print("Length hubber: ", len(list(new.index)))
print("Bojkova cut off: ", len(within))
